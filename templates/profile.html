<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Профиль</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { background: linear-gradient(135deg, #ff69b4 0%, #ffb6c1 100%); font-family: 'Montserrat', Arial, sans-serif; margin: 0; min-height: 100vh; }
        .main { max-width: 700px; margin: 60px auto; background: #fff; border-radius: 24px; box-shadow: 0 8px 32px rgba(255, 105, 180, 0.12); padding: 48px; }
        h1 { color: #ff69b4; font-size: 2.4em; text-align: center; margin-bottom: 32px; }
        p { font-size: 1.3em; color: #d72660; text-align: center; }
        .profile-input {
            width: 100%;
            padding: 12px 44px 12px 12px;
            font-size: 1em;
            border-radius: 8px;
            border: 1px solid #ff69b4;
            box-sizing: border-box;
            margin-bottom: 18px;
            background: #fff;
        }
        #togglePassword {
            position: absolute;
            top: 50%;
            right: 14px;
            transform: translateY(-50%);
            cursor: pointer;
            z-index: 2;
            font-size: 1.3em;
            color: #ff69b4;
            background: rgba(255,255,255,0.7);
            border-radius: 50%;
            padding: 2px;
            user-select: none;
        }
    </style>
</head>
<body>
    <div class="main">
        <h1>Профиль</h1>
        <form method="post" enctype="multipart/form-data" style="max-width:400px;margin:0 auto 32px auto;display:flex;flex-direction:column;gap:18px;">
            <label>Email:
                <input type="email" name="email" placeholder="Email" required class="profile-input">
            </label>
            <label>Имя:
                <input type="text" name="name" placeholder="Имя" required class="profile-input">
            </label>
            <label>Пароль:
                <div style="position:relative;">
                    <input type="password" id="password" name="password" placeholder="Пароль" required class="profile-input">
                    <span id="togglePassword">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg>
                    </span>
                </div>
            </label>
            <script>
                document.getElementById('togglePassword').onmousedown = function(e) {
                    e.preventDefault();
                };
                document.getElementById('togglePassword').onclick = function() {
                    var pwd = document.getElementById('password');
                    pwd.type = pwd.type === 'password' ? 'text' : 'password';
                }
            </script>
            <label>Фото профиля:
                <input type="file" name="photo" accept="image/jpeg" id="photo_input" style="width:100%;padding:10px;font-size:1.1em;border-radius:8px;border:1px solid #ff69b4;" onchange="previewPhoto()">
                <div id="photo_preview" style="margin-top:12px;text-align:center;"></div>
            </label>
            <script>
                function previewPhoto() {
                    var input = document.getElementById('photo_input');
                    var preview = document.getElementById('photo_preview');
                    preview.innerHTML = '';
                    if (input.files && input.files[0]) {
                        var file = input.files[0];
                        if (!file.name.toLowerCase().endsWith('.jpg')) {
                            preview.innerHTML = '<span style="color:#d72660;font-size:1em;">Фото профиля должно быть в формате .jpg!</span>';
                            return;
                        }
                        var reader = new FileReader();
                        reader.onload = function(e) {
                            preview.innerHTML = '<img src="' + e.target.result + '" style="max-width:120px;max-height:120px;border-radius:50%;border:2px solid #ff69b4;box-shadow:0 2px 8px #ffb6e6;">';
                        }
                        reader.readAsDataURL(file);
                    }
                }
            </script>
            <button type="submit" style="font-size:1.2em;background:#ff69b4;color:#fff;border:none;border-radius:10px;padding:12px;font-weight:bold;cursor:pointer;">Создать профиль</button>
        </form>
        {% with messages = get_flashed_messages(with_categories=true) %}
          {% if messages %}
            {% for category, message in messages %}
              {% if category == 'Ошибка' %}
                <div style="color:#d72660;font-size:1.1em;margin-top:8px;text-align:center;">{{ message }}</div>
              {% endif %}
            {% endfor %}
          {% endif %}
        {% endwith %}
        <a href="{{ url_for('index') }}" style="display:inline-block;margin-top:32px;font-size:1.2em;color:#fff;background:#ff69b4;border-radius:10px;padding:10px 18px;text-decoration:none;font-weight:bold;box-shadow:0 1px 4px rgba(215,38,96,0.08);transition:background 0.2s,color 0.2s;">Вернуться назад</a>
    </div>
</body>
</html>